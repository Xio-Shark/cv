# 快速使用指南

## 🎯 实验概览

本项目完成了多媒体图像处理的5个核心实验,涵盖直方图增强和DCT图像压缩。

---

## 📦 环境安装

```bash
# 安装所需Python库
pip install numpy opencv-python matplotlib pillow
```

**依赖说明:**
- `numpy`: 数值计算(必需)
- `opencv-python`: 图像读取(仅用于I/O)
- `matplotlib`: 可视化结果
- `pillow`: 图像保存

**注意:** DCT变换和直方图均衡化均为手工实现,未使用任何库函数!

---

## 🚀 运行实验

### 方法一: 运行单个实验

#### 实验一 - 直方图增强

```bash
cd 实验一/直方图增强
python histogram_enhancement.py
```

**输出:**
- `histogram_enhancement_result.png` - 可视化结果(6子图)
- 控制台输出统计信息

**参数调整:** 在 `main()` 函数中修改 `method` 变量
- `1`: 全局直方图均衡
- `2`: 标准CLAHE
- `3`: Natural CLAHE (默认,效果最自然)

---

#### 实验一 - DCT变换分析

```bash
cd 实验一/dct变换
python dct_transform.py
```

**输出:**
- `dct_result.txt` - DCT系数数据
- `dct_transform_result.png` - 可视化结果(6子图)
- 控制台输出DCT系数统计

---

#### 实验二-实验一: 8×8分块DCT

```bash
cd 实验二/1
python dct_1.py
```

**输出:**
- `processed_image.jpg` - 重建图像
- `dct_result_visualization.png` - 可视化结果(2x2布局)
- 控制台输出完整质量评价:
  - 压缩统计 (压缩比、保留比例)
  - 客观指标 (MSE, RMSE, SNR, PSNR)
  - 主观评级 (Excellent/Good/Acceptable/Fair/Poor)

**预期结果:**
- 压缩比: 64:1
- PSNR: ~30 dB
- 质量等级: Good
- 视觉效果: 明显的8×8马赛克块效应

---

#### 实验二-实验二: 整图DCT (只保留DC)

```bash
cd 实验二/2
python dct_2.py
```

**输出:**
- `whole_image_dc_only.jpg` - 重建图像
- `dct_whole_image_visualization.png` - 可视化结果
- 控制台输出完整质量评价

**预期结果:**
- 压缩比: 262,144:1 (极高)
- PSNR: ~13 dB
- 质量等级: Poor
- 视觉效果: 完全均匀的灰色图像(不可辨识)

---

#### 实验二-实验三: 整图DCT (Top-K系数)

```bash
cd 实验二/3
python dct_3.py
```

**输出:**
- `top_1000_coefficients.jpg` - 重建图像
- `dct_top_k_visualization.png` - 可视化结果
- `dct_1000_coefficients.png` - 系数分布图
- 控制台输出完整质量评价

**预期结果:**
- 压缩比: 262:1
- PSNR: ~31 dB
- 质量等级: Good
- 视觉效果: 图像可辨识,略有模糊,无块效应

**参数调整:** 在脚本中修改 `K_VALUE` 变量测试不同系数数量

---

### 方法二: 运行综合质量评价

```bash
cd 实验二
python comprehensive_quality_evaluation.py
```

**功能:**
- 自动运行三个DCT实验
- 计算所有质量指标 (MSE, RMSE, SNR, PSNR)
- 生成对比分析表格
- 输出推荐结论

**输出示例:**
```
============================================================
三个实验的综合对比
============================================================

实验                     MSE          RMSE         SNR (dB)     PSNR (dB)    主观评级            
-----------------------------------------------------------------------------------------------
实验一 (8×8分块DC)        64.8468      8.0528       20.41        30.01        Good                
实验二 (整图DC)           ~16000       ~126         ~6           13.35        Poor                
实验三 (Top-1000)         52.7300      7.2600       21.02        30.95        Good                
===============================================================================================
```

---

### 方法三: 测试质量评价工具

```bash
cd 实验二
python quality_evaluation.py
```

**功能:**
- 演示质量评价工具的使用
- 测试不同失真程度的图像
- 验证MSE/RMSE/SNR/PSNR计算正确性

---

## 📊 理解输出结果

### 质量指标含义

| 指标 | 含义 | 数值范围 | 越高越好? |
|------|------|----------|-----------|
| **MSE** | 均方误差 | [0, ∞) | ❌ 越小越好 |
| **RMSE** | 均方根误差 | [0, ∞) | ❌ 越小越好 |
| **SNR** | 信噪比 | (-∞, ∞) dB | ✅ 越大越好 |
| **PSNR** | 峰值信噪比 | [0, ∞) dB | ✅ 越大越好 |

### PSNR与主观质量对应

| PSNR范围 | 主观评级 | 视觉效果 |
|----------|----------|----------|
| > 40 dB | Excellent | 几乎无失真 |
| 30-40 dB | Good | 轻微失真,质量良好 |
| 25-30 dB | Acceptable | 可接受的失真 |
| 20-25 dB | Fair | 明显失真,勉强可用 |
| < 20 dB | Poor | 严重失真 |

### 可视化输出说明

**2x2布局 (实验二的三个实验):**
1. 左上: 原始图像
2. 右上: 重建图像
3. 左下: 统计信息文本框
4. 右下: 像素值分布直方图对比

**6子图布局 (实验一):**
1. 原始图像
2. 增强/变换后图像
3. 原始直方图/系数分布
4. 增强后直方图/系数统计
5. 原始CDF/能量累积
6. 增强后CDF/频率分布

---

## 🔧 常见问题

### Q1: 控制台显示乱码

**原因:** Windows控制台默认GBK编码不支持某些Unicode字符

**解决:** 
- 代码已修改为英文输出
- 或在PowerShell中运行: `[Console]::OutputEncoding = [System.Text.Encoding]::UTF8`

---

### Q2: matplotlib不显示中文

**原因:** 默认字体不支持中文

**解决:** 
- 代码已修改为英文标签和标题
- 若需中文,取消注释 `plt.rcParams['font.sans-serif'] = ['SimHei']`

---

### Q3: 找不到test_image.jpg

**原因:** 文件路径错误

**解决:**
- 确保在正确目录运行脚本
- 或修改脚本中的 `image_path` 参数为绝对路径

---

### Q4: 想测试不同参数

**直方图增强参数调整:**
```python
# 在 histogram_enhancement.py 的 main() 函数中
enhanced = adaptive_histogram_equalization(
    image,
    clip_limit=1.2,     # 调整对比度限制 (1.0-2.0)
    block_size=32,      # 调整分块大小 (16-64)
    blend_ratio=0.6     # 调整混合比例 (0.0-1.0)
)
```

**DCT压缩参数调整:**
```python
# 在 dct_3.py 中修改
K_VALUE = 1000  # 改为 500, 2000, 5000 等测试不同压缩比
```

---

### Q5: 想用自己的图像测试

**方法1: 替换test_image.jpg**
```bash
# 将你的图像重命名为test_image.jpg并放到对应目录
cp your_image.jpg 实验二/1/test_image.jpg
```

**方法2: 修改代码**
```python
# 在main()函数中修改
original, processed, stats = process_image("your_image.jpg")
```

**注意:** 图像会自动调整为512×512灰度图

---

## 📖 查看详细文档

### 实验原理和方法

- `实验二/DCT图像压缩实验报告.md` - 15000字完整报告
- `实验二/实验对比分析.md` - 三个实验详细对比
- `多媒体实验总结.md` - 全部实验总结

### 实现细节

- `实验二/1/CHANGELOG.md` - dct_1.py改进日志
- `实验一/直方图增强/改进说明.md` - 直方图增强改进说明
- `实验二/实验要求对照检查表.md` - 要求达成情况

### 使用说明

- `实验一/README.md` - 实验一总览
- `实验二/README.md` - 实验二总览
- `实验二/1/README.md` - dct_1.py详细说明

---

## 🎓 学习路径建议

### 初学者路径

1. **先理解概念** → 阅读 `实验二/DCT图像压缩实验报告.md`
2. **运行实验一** → `cd 实验二/1 && python dct_1.py`
3. **观察结果** → 打开生成的可视化图像,理解块效应
4. **运行实验二** → 对比整图DC的效果
5. **运行实验三** → 理解能量集中特性
6. **综合对比** → `python comprehensive_quality_evaluation.py`

### 深入研究路径

1. **研究DCT矩阵构造** → 阅读 `create_dct_matrix()` 函数
2. **理解2D DCT** → 手动计算8×8小块验证
3. **调整参数实验** → 修改K值观察PSNR变化
4. **改进算法** → 尝试实现量化和熵编码
5. **扩展应用** → 彩色图像压缩,视频压缩

---

## 💡 核心代码示例

### 手工实现DCT (不使用库函数)

```python
import numpy as np

def create_dct_matrix(n):
    """构建n×n的DCT变换矩阵"""
    C = np.zeros((n, n))
    for i in range(n):
        alpha_i = np.sqrt(1/n) if i == 0 else np.sqrt(2/n)
        for j in range(n):
            C[i, j] = alpha_i * np.cos((2*j+1) * i * np.pi / (2*n))
    return C

def dct_2d(image):
    """2D DCT变换"""
    n = image.shape[0]
    C = create_dct_matrix(n)
    F = C @ image @ C.T
    return F

def idct_2d(F):
    """2D 逆DCT变换"""
    n = F.shape[0]
    C = create_dct_matrix(n)
    image = C.T @ F @ C
    return image

# 使用示例
block = np.random.rand(8, 8)  # 8×8图像块
dct_coeffs = dct_2d(block)    # DCT变换
reconstructed = idct_2d(dct_coeffs)  # 逆变换

print(f"重建误差: {np.max(np.abs(block - reconstructed))}")  # 应接近0
```

---

## ✅ 验证实验成功

运行任一实验后,检查:

1. ✅ 控制台输出完整统计信息
2. ✅ 生成可视化PNG图像
3. ✅ 生成重建的JPG图像
4. ✅ 显示所有质量指标 (MSE, RMSE, SNR, PSNR)
5. ✅ 显示主观评级 (Excellent/Good等)

---

## 📞 技术支持

如遇问题,请检查:

1. Python版本 ≥ 3.7
2. 依赖库已正确安装
3. 在正确目录运行脚本
4. 测试图像文件存在

---

**祝实验顺利! 🎉**

---

**最后更新:** 2025年10月28日  
**适用版本:** 所有实验最终版本

